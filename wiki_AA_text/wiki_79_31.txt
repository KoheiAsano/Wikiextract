不確定性原理
不確定性原理（ふかくていせいげんり、 ）は、量子力学に従う系の物理量formula_1を観測したときの不確定性と、同じ系で別の物理量formula_2を観測したときの不確定性が適切な条件下では同時に0になる事はないとする一連の定理の総称である。特に重要なのはformula_1、formula_2がそれぞれ位置と運動量のときであり、狭義にはこの場合のものを不確定性原理という。
このような限界が存在するはずだという元々の発見的議論がハイゼンベルクによって与えられたため、これはハイゼンベルクの原理という名前が付けられることもある。しかし後述するようにハイゼンベルグ自身による不確定性原理の物理的説明は、今日の量子力学の知識からは正しいものではない。
今日の量子力学において、不確定性原理でいう観測は日常語のそれとは意味が異なるテクニカル・タームであり、観測機のようなマクロな古典的物体とミクロな量子物体との間の任意の相互作用を意味する。したがって例えば、実験者が観測機に表示された観測値を実際に見たかどうかといった事とは無関係に定義される。また不確定性とは、物理量を観測した時に得られる観測値の標準偏差を表す。
不確定性原理が顕在化する現象の例としては、原子（格子）の零点振動（このためヘリウムは、常圧下では絶対零度まで冷却しても固化しない）、その他量子的なゆらぎ（例：遍歴電子系におけるスピン揺らぎ）などが挙げられる。
歴史的に、不確定性原理は観察者効果と呼ばれる物理学におけるいくらか似た効果と混同されてきた。観察者効果とは、系を測定する行為それ自身が系に影響を与えてしまうというものである。
量子力学が成立するミクロな世界が測定による観測者効果で「揺動」してしまうという説明は、ハイゼンベルグ自身が当初不確定性原理に対して与えたものであり、今日において（専門家向けの教科書にはともかく、素人向けの啓蒙書等では）繰り返し出てくるものの、根本的に誤解を招く恐れのあることが現在は知られている。
「不確定性原理は実際には量子系の基本的特性を述べており、現代のテクノロジーにおける測定精度の到達点ついて述べたものではない」。不確定性原理は全ての波のような系にもともと備わっている特性であること、不確定性は単純に全ての量子物体の物質波の性質によって現われることが今日の量子力学ではわかっている。
以上のように不確定性原理は量子状態そのものが持っている不確定性であり、測定器の誤差と測定による反作用との不確定性とは区別して考えなければならない。量子論での時間発展や測定についての基本的要請をすべてを使って展開できる量子測定理論を用いて、ハイゼンベルクの考察した「測定精度と反作用に関する不確定性原理」ははじめて導けるが、その結果得られる不等式の下限はケースバイケースで変わることが判っている。。後述する小澤の不等式などがその１つである。
不確定性原理で特に重要になるのは、物理量formula_1と物理量formula_2がそれぞれ(軸方向の)位置formula_7と運動量formula_8である場合である。系が状態にあるときのこれらの不確定性をそれぞれformula_9、formula_10とするとき、以下が成立する：
ここでformula_11は換算プランク定数である。なお本項ではH13に従い、不確定性をformula_9と表記したが、多くの物理の教科書では系の状態を省略しformula_13と表記する。
上式右辺は0より真に大きいので、位置の不確定性formula_9が0に近い値であればformula_10は極端に大きくなり、逆にformula_10が0に近い値であればformula_9は極端に大きくなる。両方共0に近い値にする事はできない。
一般の物理量formula_1、formula_2に対する不確定性原理として、以下のロバートソンの不等式がある：
ここでformula_20はformula_1とformula_2の交換子
であり、formula_24は系の状態がであるときにformula_20を観測したときの観測値の期待値である。
これまでについて詳しく書いてこなかったが、実はが適切な定義域に属している場合にしか不確定性原理は成り立たず、そうでない場合には反例がある事が知られているので注意が必要である。そこで次節でこの点を考慮して不確定性原理を厳密に定式化する。
不確定性原理を定式化する為の予備知識を説明する。量子力学において（純粋）量子状態は状態空間formula_26という複素内積ベクトル空間（ヒルベルト空間）における長さ1のベクトル（状態ベクトル）として記述され、物理量（オブザーバブルと呼ぶ）はformula_26上の自己共役作用素として定式化される。
粒子が個ある系の場合formula_26は、次元空間formula_29上の複素数値の自乗可積分函数全体の空間と同一視でき、このようにみなした場合、状態ベクトルのことを波動関数と呼ぶ。formula_30軸方向の位置作用素formula_7と運動量作用素formula_8はそれぞれ
により定義される。ここでformula_11は換算プランク定数である。
不確定性原理を定式化する準備として、オブザーバブルの定義域に関して述べる。後でみるように、不確定性原理を厳密に定式化する際、オブザーバブルの定義域に関して細心の注意を払わないと、反例がつくれてしまうからである。
まず運動量作用素と位置作用素の定義域に関して調べる。定義から分かるように、運動量作用素は波動関数が微分可能な場合しか定義できないが、自乗可積分関数の中には微分可能でないものもあるので、運動量作用素は状態空間formula_26の全域では定義できず、formula_26の部分空間でのみ定義された作用素である。また位置作用素に関しても、formula_33が常に自乗可積分関数になるわけではないので、formula_33が自乗可積分関数になるようなformula_40に対してしか位置作用素を定義できない（そうしないとformula_7の値域がformula_26からはみ出してしまうので、formula_7がformula_26上の自己共役作用素にならない）。こうした事情から量子力学では、オブザーバブルformula_1がformula_26の部分空間でのみでしか定義されていないケースをも許容し、代わりに定義域formula_47がformula_26で稠密になる事を要請する。
オブザーバブルformula_1がformula_26の部分空間でのみでしか定義されない事を許容した事が原因で、2つのオブザーバブルformula_1、formula_2の交換子
も常に定義できるとは限らない。実際、積formula_54は
のときしか意味を持たないし、formula_57にも同様の制約が課せられる。結局formula_53が意味を持つのは、
が全て成り立つときのみである。
状態空間formula_26上２つの元、に対し、との内積をformula_63と書き表し、さらに
とする。オブザーバブルformula_1と状態ベクトルformula_66に対し、
と定義し、さらにformula_1のformula_66に対する不確定性を
により定義する。ここでは単位行列である。formula_71とformula_72は物理的にはそれぞれ、状態formula_73にある系でformula_1を観測した時に得られる観測値の平均値と標準偏差である。
formula_1、formula_2を状態空間formula_26上のオブザーバブルとし、formula_78が
を満たしているとする。このとき、formula_53が定義可能であり、以下の不等式（ロバートソンの不等式）が成立する：
証明は後述する。
次元空間上の自乗可積分関数全体の空間formula_84における番目の位置作用素と運動量作用素
に関しては、の定義域に関する条件を弱めることができる事が知られている。
すなわち状態空間がformula_88であるとき、
であれば、
が成立する。
なお、
である。ここで「偏微分可能」は通常の意味の偏微分が可能である事を含むのはもちろん、弱微分の意味での偏微分が可能であるものも許容する。
証明は引用文献H13のp246~248を参照されたい。
本節の証明は引用文献H13p243を参考にした。が定理の条件を満たす時formula_96が定義可能であることは既に見たので、以下不等式が成り立つことの証明のみに注力する。記法を簡単にするため
とする。単位行列がformula_26の全域で定義されている事を利用すると、の条件formula_59、formula_56、formula_61より、
がいずれも定義可能である事が簡単な議論で分る。
コーシー・シュワルツの不等式により、
formula_105、formula_106が定義可能であったので、
単位行列は全ての作用素と可換なので、
よってロバートソンの不等式が証明された。
これまで我々はが定義域に関する条件を満たしていればロバートソンの不等式が成立する事を示し、さらにformula_84における位置作用素と運動量作用素の場合には、この条件が緩められる事を見た。
しかし単位区間上の自乗可積分関数の集合formula_121における位置作用素と運動量作用素の場合には、不確定性原理が成り立たない反例が存在する。この反例は
よってこの反例の存在はこれまでの成果と矛盾しない。
なおこの反例は引用文献H13p245~246によった。
1次元空間formula_124上の自乗可積分関数に対する通常の位置作用素formula_125、運動量作用素formula_126と区別するため、上の自乗可積分関数に対する位置作用素と運動量作用素をそれぞれformula_127、formula_128と書くことにする。すなわち
である事は通常のformula_125、formula_126と変わらないが、formula_125、formula_126の場合と違い、は全体で定義された関数ではなく、区間でのみ定義された関数である。
区間上の自乗可積分関数に対し、区間上の積分formula_136は必ず有限値になるので、
でとしてよい。
一方、、が周期性formula_139、formula_140を満たす可微分関数であれば、formula_128が対称性を満たす事を簡単な計算で示すことができる：
よって
としてよい。（なお、formula_128の自己共役性を示すには、「可微分」を弱微分の意味に解釈する必要があるが、本項の範囲を超えるので詳細は省略する）。
が可微分であれば、
より、
が成立する。したがって特に、ロバートソンの不等式の定義域に関する条件を満たしている場合には、上式が成立する。
しかし
とすると、ロバートソンの不等式の左辺が0になる事を示すことができる。
なぜなら、
よりはformula_128の長さ1の固有関数であるので、formula_157は0になる：
一方明らかに
なので、 
ロバートソンの不等式が成り立つためには、
でなければならなかった。しかし上述したは
は
であるので、formula_165の周期性の条件を満たさない。よって
であり、ロバートソンの不等式の条件が満たされない。
小澤正直は、（当初のハイゼンベルクの思考実験では混同されており、ボーアが指摘している）測定限界や測定することによる対象の擾乱や測定誤差と、量子自体の性質（不確定性関係）による量子ゆらぎを厳密に区別した式（小澤の不等式）を提案した。式の形は、ハイゼンベルクの式に補正項を付け加えた形になる。さらに、その式に従えば（従来のハイゼンベルクの式に従って信じられていた）「ハイゼンベルクの不確定性原理による測定の限界」を超えて、量子に対する精度の良い測定が可能であると、2003年1月に発表した（この結果につながった論争は、1980年代に、重力波検出装置の可能性と限界を巡って始まったものである）。オブサーバブル formula_167 の測定の誤差（すなわち精度）を formula_168、測定過程による撹乱を formula_169、量子ゆらぎを formula_170 とすると以下の不等式が成り立つ。 
位置と運動量の測定の関係を小澤の不等式に当てはめると、
となる。この改良された不等式から見ると、1927年に発表されたハイゼンベルクの不確定性原理は上式の第1項についてのみ述べていたということになる。
小沢の不等式が示す測定誤差 (左辺の第1項) の下限は、ハイゼンベルクの不等式が示していた測定誤差下限よりも第2項、第3項の分だけ小さい。このことは、ハイゼンベルクの不等式が示した限界よりも精度の良い測定ができる可能性を示唆しており、実際にそのような小澤の不等式を実証する実験結果が2012年に発表された。この実験では原子炉から出る中性子のスピン角度を2台の装置によってはかり、ハイゼンベルクの不等式の限界を超えて精度よく測定することに成功したと発表された。
時間とエネルギーに関しては、観測量の分散に対するロバートソン不等式を論じることは一般にできない。それはエネルギー固有値が連続でかつ上限および下限を持たない量子系でなければ、ハミルトニアン に正準共役な時間演算子 は定義できないためである。もし考えている量子系においてエルミートな が存在して
を満たすならば、任意の実数 に対して
というユニタリ変換が存在する。これをあるエネルギー固有値 に対応する固有状態 に作用させると、得られる状態は
という関係を満たすため、エネルギー固有値が のエネルギー固有状態を得たことになる。しかし は負の無限大から正の無限大の間の任意の実数値をとれるため、エネルギー固有値も連続的となり下限も上限もなくなる。安定した基底状態をもつ量子系ではエネルギー固有値は下限をもつため、エルミートな時間演算子は存在しないことが証明される。従って安定な基底状態をもつ通常の量子系では、時間とエネルギーに関するロバートソン不等式は意味を持たない。同様に、時間とエネルギーに関しては小澤の不等式も意味を持たない。
なお未知の時間パラメータformula_175に依存する量子状態 を量子測定して、その測定結果から の値を推定する場合には、その推定誤差 とハミルトニアンの標準偏差との間に不等式 formula_176 が成立することは知られている。しかしこれはロバートソン不等式や小澤の不等式ではなく、量子推定理論のクラメール・ラオ不等式からの帰結である。
ハミルトニアン によって時間発展した状態が初期状態に比べて有意に変化するには、formula_177以上の経過時間が必要である。この関係を時間とエネルギーの不確定性関係の一種とみなす場合もある。しかしエネルギーの標準偏差formula_178と、状態差が生まれるための経過時間 との積の下限は という普遍的な値を持たず、使用する状態差の指標等の詳細に依存する。
一方、エネルギーの測定誤差とエネルギーの測定にかかる時間との間には原理的な不確定性関係は存在しない。1930年のソルヴェイ会議でのアインシュタインとの不確定性原理の論争において、ボーアが測定時間とエネルギーの誤差の不確定性関係を破る光子箱の思考実験を論破したと言われているが、この時のボーアの議論は正確ではない。例えば重力場を電場に、光子を電子に置き換えることによって、光子箱と同様のエネルギー測定の思考実験が作れる。しかしこの場合は一般相対性理論を必要とせず、重力ポテンシャルと時間の遅れの関係式も不必要となるため、ボーアが考えた測定時間とエネルギーの測定誤差の不確定性関係は成立しないことが示される。他の物理量と同様に、エネルギーは任意の時刻で正確に測定できる。例えば一定外部磁場 中のスピン が持つエネルギー の精密測定は、スピンの磁場方向成分の精密測定で実現できる。スピンの特定方向成分の理想測定はその測定時間に原理的制約を持たないため、いくらでも短い測定時間の間に磁場方向のスピンの精密測定はできる。従ってそのエネルギーも測定時間に関係なく精密測定ができる。
時間とエネルギーの不確定性関係のために短時間ではエネルギー保存則が破れるという説も流布しているが、それに根拠はない。フェルミの黄金律等の摂動論において議論されている有限時間でのエネルギー保存則の破れは、相互作用項を無視した自由ハミルトニアン のみに対する議論にすぎない。相互作用があると は時間的に保存しないが、相互作用項 まで取り入れた全ハミルトニアン 自体は任意の時刻で保存しており、エネルギー保存則は量子力学でも破れることはない。場の量子論では、エネルギー運動量テンソル演算子 を用いて
という局所的表現でエネルギー保存則は与えられる。他の量子系と同様に、短時間でもエネルギー保存則が破れることはない。ファインマンダイアグラムを用いた摂動論において、仮想粒子が実粒子の間を媒介して力を伝達する事象をエネルギー保存則の破れで簡易に説明する場合があるが、厳密に言うとその破れは相互作用項を無視した自由ハミルトニアンの保存則の破れを指す。場の量子論においても相互作用項まで取り入れたエネルギー保存則は破れることはない。
1927年にヴェルナー・ハイゼンベルクは、ある粒子の位置をより正確に決定する程、その運動量を正確に知ることができなくなり、逆もまた同様である、と述べた。位置の標準偏差 と運動量の標準偏差 を結び付ける不等式は1927年にアール・ヘッセ・ケナードによって、1928年にヘルマン・ワイルによって導出された。
