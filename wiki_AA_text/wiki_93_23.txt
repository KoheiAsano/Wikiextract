ユークリッドの互除法
ユークリッドの互除法（ユークリッドのごじょほう、）は、2 つの自然数の最大公約数を求める手法の一つである。
2 つの自然数 "a", "b" ("a" ≧ "b") について、"a" の "b" による剰余を "r" とすると、 "a" と "b" との最大公約数は "b" と "r" との最大公約数に等しいという性質が成り立つ。この性質を利用して、 "b" を "r" で割った剰余、 除数 "r" をその剰余で割った剰余、と剰余を求める計算を逐次繰り返すと、剰余が 0 になった時の除数が "a" と "b" との最大公約数となる。
明示的に記述された最古のアルゴリズムとしても知られ、紀元前300年頃に記されたユークリッドの『原論』第 7 巻、命題 1 から 3 がそれである。
(問題) 1071 と 1029 の最大公約数を求める。
よって、最大公約数は21である。
"a", "b" は自然数で "a" ≠ 0 とする。
"b" を "a" で割った商を "q"、剰余を "r" とすると
今、"d" を "a" と "r" の両方を割り切る自然数とする。
このとき "d" は積 "qa" を割り切るから、和 "qa" + "r" も割り切るが、"qa" + "r" は "b" に等しい。したがって、"d" は "a" と"b" を割り切る。すなわち "a" と "r" の公約数はすべて"b" と "a"の公約数である。
逆に、"d" を "b" と "a" の両方を割り切る自然数とする。
"d" は "qa" を割り切るから差 "b" - "qa" を割り切るが、"b" - "qa" は "r" に等しい。したがって、"d" は "a" と"r"を割り切る。言い換えると "b" と "a" の公約数はすべて"a" と "r" の公約数である。
したがって、"b" と "a" の公約数全体の集合は "a" と "r" の公約数全体の集合に等しく、特に "b" と "a" の最大公約数は "a" と "r" の最大公約数でなければならない。
手続き的に記述すると、次のようになる。
上記の手順は「"n", "m" に対して剰余の演算を行うことができる」という仮定だけに依っているので、整数環だけではなく任意のユークリッド整域においても同様にして最大公約因子を求めることができる。
整数 "m", "n" の最大公約数 () を gcd("m","n") と表すときに、（拡張された）ユークリッドの互除法を用いて、"mx" + "ny" = gcd("m", "n") の解となる整数 "x", "y" の組を見つけることができる。上の例の場合、"m" = 1071, "n" = 1029 のとき、
であるから、gcd(1071, 1029) = 21 であり、
となるので、"x" = −24, "y" = 25 である。
特に、"m", "n" が互いに素（最大公約数が 1）である場合、"mx" + "ny" = 1 の整数解を ("x", "y") とすると、"mx" + "ny" = "c" は任意の整数 "c" に対して整数解 ("cx", "cy") をもつことが分かる。
一般に、formula_1
において、ユークリッドの互除法の各過程を繰り返して
が得られるとき、
すなわち
ここで
これらの過程において、formula_17、ユークリッドの互除法により、formula_18であるから、formula_19を考慮すると、
となる。
とおき、ユークリッドの互除法の各過程で得られた formula_22, formula_23, formula_24等を用いて、右辺を計算すれば、左辺のformula_25, formula_26 が求まり、これはベズーの等式
を満たす。
割って余りを取るという操作を、最悪でも小さい方の十進法での桁数の約 5 倍繰り返せば、最大公約数に達する（ラメの定理）。
最大公約数を求めるのに、素因数分解してみればいいと考える人がいるかもしれないが、この定理は素因数分解を用いるよりもユークリッドの互除法による方が"はるかに"速いということを述べている。
実際、計算複雑性理論においては最大公約数を求めることは「容易な問題」として知られており、素因数分解は「困難な問題」であろうと考えられている。
入力された2つの整数のうち小さいほうの整数 "n" の桁数を "d" とすれば、ユークリッドの互除法では O("d") 回の除算で最大公約数が求められる。桁数 "d" は O(log "n") なので、ユークリッドの互除法では O(log "n") 回の除算で最大公約数が求められる。
上の例で出てきた、1071 と 1029 の最大公約数を求める過程は、次のように表せる。
すなわち、
したがって、
このように、 "n" と "m" ("n" > "m") の最大公約数を求める際のユークリッドの互除法の割り算の商は、有理数 "n"/"m" の連分数展開になっている。
